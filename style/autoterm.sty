\NeedsTeXFormat{LaTeX2e}

\RequirePackage{expl3}
\ProvidesExplPackage{autoterm}{2016/04/22}{0.1.0}{YaBAskY::Utility::AutoTerm}

\prop_new:c { g_autoterm_fullname_cn }
\prop_new:c { g_autoterm_fullname_en }

\cs_new:Npn \new_term:nnn #1#2#3
  {
    \prop_put:cnn { g_autoterm_fullname_en } { #1 } { #2 }
    \prop_put:cnn { g_autoterm_fullname_cn } { #1 } { #3 }
    \newcounter{ term_counter_#1 }
  }

\cs_new:Npn \ref_term:n #1
  {
    \prop_get:cnN { g_autoterm_fullname_cn } { #1 } \l_name_cn
    \prop_get:cnN { g_autoterm_fullname_en } { #1 } \l_name_en
    \int_compare:nTF { \arabic{ term_counter_#1 } > 0 }
      {
        { #1 }
      }
      {
        \l_name_cn(\l_name_en, { #1 })
      }
    \stepcounter{ term_counter_#1 }
  }

\NewDocumentCommand \SetTerm { mmm }
  {
    \new_term:nnn { #1 } { #2 } { #3 }
    \expandafter\NewDocumentCommand \csname #1 \endcsname { } { \ref_term:n { #1 } }
  }

